params {
    input = ""
    output = "./output"
    mamba = false
    workDir = "./nextflow_workdir"
    array = 100
}

workDir = params.workDir

profiles {
    standard {
        params.threads = Runtime.runtime.availableProcessors()
        params.forks = params.threads - 1
        params.executor = 'local'
        process.executor = 'local'
        process.cpus = 1
        process.memory = { 512.MB * task.attempt }
        process.maxForks = params.forks
        conda.enabled = true
        process.conda = "$projectDir/envs/clustering.yml"
        if (params.mamba != false) {
            conda.useMamba = true
        }
    }
    slurm {
        params.threads = 32
        params.maxThreads = 64
        params.forks = 16
        params.queueSize = params.forks
        params.queue = "bcf"
        params.executor = 'slurm'
        process.executor = 'slurm'
        process.queue = params.queue
        process.cpus = 1
        process.memory = { 512.MB * task.attempt ** 2 }
        process.maxForks = params.forks - 1
        executor.queueSize = params.queueSize
        conda.enabled = true
        process.conda = "$projectDir/envs/clustering.yml"
        process.errorStrategy = "retry"
        process.maxRetries = 3
        if (params.mamba != false) {
            conda.useMamba = true
        }
    }
}
